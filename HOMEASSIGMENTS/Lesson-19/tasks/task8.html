<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DZ-№19</title>
</head>

<body>
    <h1>Задача 8</h1>
    <style>
        #container {
            position: relative;
            width: 800px;
            height: 800px;
            border: 1px solid #000;
        }

        .cockroach {
            position: absolute;
            width: 50px;
            height: 50px;
            background: url('cockroach.png') no-repeat center center;
            background-size: contain;
            cursor: pointer;
        }

        .sleeping {
            background: url('/Lesson-19/tasks/sleeping.png') no-repeat center center;
            background-size: contain;
        }
    </style>
    <p>
        8 Задача. Ловля тараканів. Зображення тараканів з’являються в центрі контейнера і випадковим чином «розбігаються» у випадкових напрямках.<br>
        При кліку на зображенні таракана його рух припиняється і виводиться зображення сплячого таракана.<br>
    </p>
    <div id="container"></div>
    <script>
        class Cockroach {
            constructor(container) {
                this.container = container
                this.element = document.createElement('div')
                this.element.classList.add('cockroach')
                this.container.appendChild(this.element)

                this.setPosition()
                this.setDirection()
                this.move()

                this.element.addEventListener('click', this.sleep.bind(this))
            }

            setPosition() {
                const containerRect = this.container.getBoundingClientRect()
                const maxX = containerRect.width - this.element.offsetWidth
                const maxY = containerRect.height - this.element.offsetHeight

                this.element.style.left = Math.random() * maxX + 'px'
                this.element.style.top = Math.random() * maxY + 'px'
            }

            setDirection() {
                this.dx = Math.random() > 0.5 ? 1 : -1
                this.dy = Math.random() > 0.5 ? 1 : -1
            }

            move() {
                this.intervalId = setInterval(() => {
                    const containerRect = this.container.getBoundingClientRect()
                    const elementRect = this.element.getBoundingClientRect()
                    const maxX = containerRect.width - elementRect.width
                    const maxY = containerRect.height - elementRect.height

                    let newX = parseFloat(this.element.style.left) + this.dx * Math.random() * 5
                    let newY = parseFloat(this.element.style.top) + this.dy * Math.random() * 5

                    if (newX < 0 || newX > maxX) {
                        this.dx *= -1
                        newX = parseFloat(this.element.style.left) + this.dx * Math.random() * 5
                    }

                    if (newY < 0 || newY > maxY) {
                        this.dy *= -1
                        newY = parseFloat(this.element.style.top) + this.dy * Math.random() * 5
                    }

                    this.element.style.left = newX + 'px'
                    this.element.style.top = newY + 'px'
                }, 100)
            }

            sleep() {
                clearInterval(this.intervalId)
                this.element.classList.add('sleeping')
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const container = document.getElementById('container')

            for (let i = 0; i < 5; i++) {
                new Cockroach(container)
            }
        })
    </script>
</body>

</html>